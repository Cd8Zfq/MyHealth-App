<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>{% block title %}MyHealth{% endblock %}</title>
    
    <!-- Police Nunito -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-bg-page text-mainText font-sans antialiased min-h-screen flex flex-col selection:bg-blue-100 selection:text-blue-900">

    <!-- Desktop Header (Minimalist) -->
    <header class="hidden md:flex fixed top-0 w-full z-50 bg-white/80 backdrop-blur-md border-b border-gray-100">
        <div class="max-w-4xl mx-auto px-6 h-20 flex items-center justify-between w-full">
            <a href="{{ url_for('main.index') }}" class="flex items-center gap-3">
                <div class="bg-blue-50 text-blue-600 p-2 rounded-2xl">
                    <i data-lucide="activity" class="w-6 h-6"></i>
                </div>
                <span class="font-extrabold text-xl text-gray-900 tracking-tight">MyHealth</span>
            </a>

            <nav class="flex items-center gap-8 font-bold text-gray-500">
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('main.home') }}" class="hover:text-blue-600 transition-colors">Tableau de bord</a>
                    <a href="{{ url_for('main.history') }}" class="hover:text-blue-600 transition-colors">Historique</a>
                    <a href="{{ url_for('main.reminders') }}" class="hover:text-blue-600 transition-colors">Rappels</a>
                    <a href="{{ url_for('main.profile') }}" class="hover:text-blue-600 transition-colors">Profil</a>
                    <a href="{{ url_for('main.logout') }}" class="text-red-400 hover:text-red-600 transition-colors">DÃ©connexion</a>
                {% else %}
                    <a href="{{ url_for('main.login') }}" class="hover:text-blue-600 transition-colors">Se connecter</a>
                    <a href="{{ url_for('main.register') }}" class="px-6 py-3 bg-blue-600 text-white rounded-2xl hover:bg-blue-700 transition-all shadow-lg shadow-blue-200">S'inscrire</a>
                {% endif %}
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow pt-6 md:pt-28 px-4 pb-32 md:pb-12 max-w-md md:max-w-4xl mx-auto w-full">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="mb-8 space-y-4">
            {% for category, message in messages %}
              <div class="p-4 rounded-3xl text-sm font-bold flex items-center gap-4 shadow-[0_8px_30px_rgb(0,0,0,0.04)]
                          {% if category == 'error' %}bg-white text-red-500 border border-red-50
                          {% elif category == 'success' %}bg-white text-green-500 border border-green-50
                          {% else %}bg-white text-blue-500 border border-blue-50{% endif %}">
                  <div class="p-2 rounded-full shrink-0
                              {% if category == 'error' %}bg-red-50
                              {% elif category == 'success' %}bg-green-50
                              {% else %}bg-blue-50{% endif %}">
                      {% if category == 'error' %}<i data-lucide="alert-circle" class="w-5 h-5"></i>
                      {% elif category == 'success' %}<i data-lucide="check" class="w-5 h-5"></i>
                      {% else %}<i data-lucide="info" class="w-5 h-5"></i>{% endif %}
                  </div>
                  <span>{{ message }}</span>
              </div>
            {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <!-- Mobile Bottom Navigation (Design System HealthTech Soft) -->
    {% if current_user.is_authenticated %}
    <nav class="md:hidden fixed bottom-0 left-0 w-full bg-white/90 backdrop-blur-xl border-t border-white/20 z-50 pb-safe rounded-t-[2.5rem] shadow-[0_-10px_40px_rgba(0,0,0,0.05)]">
        <div class="grid grid-cols-5 h-24 items-center px-2">
            <!-- Home -->
            <a href="{{ url_for('main.home') }}" class="flex flex-col items-center justify-center gap-1 group">
                <div class="p-3 rounded-2xl transition-all duration-300 {% if request.endpoint == 'main.home' %}bg-blue-50 text-blue-600{% else %}text-gray-400 group-hover:text-gray-600{% endif %}">
                    <i data-lucide="home" class="w-6 h-6 {% if request.endpoint == 'main.home' %}stroke-[3]{% endif %}"></i>
                </div>
            </a>

            <!-- History -->
            <a href="{{ url_for('main.history') }}" class="flex flex-col items-center justify-center gap-1 group">
                <div class="p-3 rounded-2xl transition-all duration-300 {% if request.endpoint == 'main.history' %}bg-blue-50 text-blue-600{% else %}text-gray-400 group-hover:text-gray-600{% endif %}">
                    <i data-lucide="bar-chart-2" class="w-6 h-6 {% if request.endpoint == 'main.history' %}stroke-[3]{% endif %}"></i>
                </div>
            </a>
            
            <!-- Add (Main Action) -->
            <a href="{{ url_for('main.select_measurement_method') }}" class="flex flex-col items-center justify-center -mt-8">
                <div class="bg-blue-600 text-white p-5 rounded-[1.5rem] shadow-[0_10px_25px_rgba(37,99,235,0.4)] transition-transform active:scale-90 border-4 border-bg-page">
                    <i data-lucide="plus" class="w-8 h-8 stroke-[3]"></i>
                </div>
            </a>
            
            <!-- Reminders -->
            <a href="{{ url_for('main.reminders') }}" class="flex flex-col items-center justify-center gap-1 group">
                <div class="p-3 rounded-2xl transition-all duration-300 {% if request.endpoint == 'main.reminders' %}bg-blue-50 text-blue-600{% else %}text-gray-400 group-hover:text-gray-600{% endif %}">
                    <i data-lucide="bell" class="w-6 h-6 {% if request.endpoint == 'main.reminders' %}stroke-[3]{% endif %}"></i>
                </div>
            </a>
            
            <!-- Profile -->
            <a href="{{ url_for('main.profile') }}" class="flex flex-col items-center justify-center gap-1 group">
                <div class="p-3 rounded-2xl transition-all duration-300 {% if request.endpoint == 'main.profile' %}bg-blue-50 text-blue-600{% else %}text-gray-400 group-hover:text-gray-600{% endif %}">
                    <i data-lucide="user" class="w-6 h-6 {% if request.endpoint == 'main.profile' %}stroke-[3]{% endif %}"></i>
                </div>
            </a>
        </div>
    </nav>
    {% endif %}

    <script>
        lucide.createIcons();
    </script>
</body>
</html>